import{c as O,r as d,z as ce,o as De,B as ie,b as l,m as D,a as i,e as v,f as a,g as _,k as q,i as y,F as p,C as f,h as V,t as r,D as $,G as Pe,w as J,v as te,l as P,T as Ue,n as H,u as je,x as qe,S as Ve}from"./index.D6qiF35X.js";import{w as Oe,_ as Be,S as Fe,c as Ye,q as ze,p as Ke,g as We,s as Qe}from"./SectionMain.LQE99ZwY.js";import{_ as Ge,a as He}from"./NotificationBar.DxHywnn9.js";import{B as Je}from"./BaseTable.Dw-ahIFq.js";import{_ as k}from"./BaseButton.CMgDjKct.js";import{_ as Le}from"./Badge.BDCNorzU.js";import{u as Ie}from"./evaluation.pveRqXOg.js";import{u as Me,s as Ne}from"./department.C1lO3iao.js";import{_ as Te}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./BaseIcon.B-kGt5NE.js";const Xe={key:0,class:"fixed inset-0 z-50 grid place-items-center bg-black/35 backdrop-blur-[1px]"},Ze={class:"bg-white rounded-2xl shadow-2xl w-full max-w-7xl overflow-hidden"},et={class:"px-4 sm:px-6 py-3 border-b flex items-center justify-between"},tt={class:"flex items-center gap-3"},at={class:"hidden md:flex items-center text-xs text-gray-500 gap-2"},st={class:"p-4 sm:p-6 grid grid-cols-1 xl:grid-cols-4 gap-4 max-h-[78vh] overflow-y-auto"},lt={class:"xl:col-span-1 space-y-4"},it=["value"],nt={key:0,class:"text-xs text-red-600 mt-1"},rt=["onKeydown"],ot={key:0,class:"p-2 text-xs text-gray-500"},dt=["data-user-id","onClick","onKeydown"],ut={class:"truncate"},ct={key:0,class:"text-[11px] text-gray-500"},vt={key:0,class:"p-2 text-xs text-gray-500"},mt={key:0,class:"text-xs text-red-600 mt-1"},pt={class:"grid grid-cols-2 gap-2"},gt=["value"],ft={key:0,class:"text-xs text-red-600 mt-1"},yt=["value"],_t={class:"pt-2 flex justify-end"},xt={class:"px-3 py-2 border-b flex items-center justify-between"},bt={class:"p-3"},kt={key:0,class:"text-xs text-gray-500 mb-2"},wt={class:"max-h-72 overflow-auto divide-y"},ht=["onDragstart"],St={class:"text-sm text-gray-800"},$t={class:"flex justify-end gap-2 mt-1"},Ct={key:0,class:"p-2 text-xs text-gray-500"},At={key:0,class:"text-xs text-red-600"},Dt={class:"px-3 py-2 border-b flex items-center justify-between"},Et={class:"font-medium text-sm"},Vt={class:"flex items-center gap-2 text-xs"},Lt={class:"flex items-center gap-1"},Ut={class:"flex items-center gap-1"},It={class:"p-3"},Mt=["onDragstart"],Nt={class:"text-sm font-medium text-gray-800"},Tt={class:"grid grid-cols-3 gap-2 mt-2 items-center"},Rt={class:"text-[11px] text-gray-600"},Pt=["onUpdate:modelValue"],jt={class:"text-[11px] text-gray-600"},qt=["onUpdate:modelValue"],Ot={class:"text-[11px] text-gray-600"},Bt=["onUpdate:modelValue"],Ft={class:"flex justify-end mt-2"},Yt={key:0,class:"text-xs text-red-600 mt-2"},zt={key:1,class:"text-xs text-gray-500 border border-dashed rounded p-3 text-center"},Kt={class:"pt-3 flex justify-end"},Wt={class:"rounded-xl border"},Qt={class:"p-3 space-y-2"},Gt={key:0,class:"max-h-40 overflow-auto border rounded"},Ht={key:0,class:"p-2 text-xs text-gray-500"},Jt={class:"truncate"},Xt={key:0,class:"p-2 text-xs text-gray-500"},Zt={class:"flex flex-wrap gap-2"},ea=["onClick"],ta={class:"px-4 sm:px-6 py-3 border-t flex items-center justify-between"},aa={class:"flex items-center gap-2"},sa={__name:"EvaluationUI2Modal",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","submitted"],setup(Ee,{emit:w}){const B=Ee,ae=w,T=Ie(),L=Me(),j=O({get:()=>B.modelValue,set:t=>ae("update:modelValue",t)}),ke=(()=>{const t=new Date().getFullYear();return Array.from({length:6},(e,s)=>`${t+s}-${t+s+1}`)})(),ve=["1st Semester","2nd Semester","Summer"],u=d({department_id:"",assigned_to_id:"",academic_year:"",semester:""}),h=d({}),C=d(1),x=d(null),M=d(null),F=d(null),ne=d(null),me=d(null),pe=d(null),X=d([]),re=d(!1),Z=d(""),Y=O(()=>{const t=Z.value.trim().toLowerCase(),e=(X.value||[]).filter(s=>String(s?.membership?.role||"").toLowerCase()==="member");return t?e.filter(s=>String(s.username||"").toLowerCase().includes(t)||String(s.first_name||"").toLowerCase().includes(t)||String(s.last_name||"").toLowerCase().includes(t)):e}),g=d([]),m=d(!1),E=d(""),R=O(()=>{const t=E.value.trim().toLowerCase();return t?g.value.filter(e=>String(e.description||"").toLowerCase().includes(t)||String(e.id).includes(t)):g.value}),b=d([]),S=d("in_progress"),z=d("medium"),N=d(()=>{const t=new Date;t.setDate(t.getDate()+7);const e=s=>String(s).padStart(2,"0");return`${t.getFullYear()}-${e(t.getMonth()+1)}-${e(t.getDate())}`}),U=d(null),ge=t=>{U.value=t},fe=()=>{U.value&&(de(U.value),U.value=null)},oe=async()=>{if(X.value=[],!!u.value.department_id){re.value=!0;try{const t=await L.fetchMembers(u.value.department_id,!0);X.value=Array.isArray(t)?t:[]}finally{re.value=!1}}},ye=async()=>{if(g.value=[],!!u.value.department_id){m.value=!0;try{const t=await Ne.list({department_id:u.value.department_id,limit:200});g.value=Array.isArray(t?.data)?t.data:[]}finally{m.value=!1}}},de=t=>{!t||!t.id||b.value.find(e=>e.id===t.id)||(b.value.push({id:t.id,description:t.description,status:S.value,priority:z.value,deadline:typeof N.value=="function"?N.value():N.value}),g.value=(g.value||[]).filter(e=>e.id!==t.id),xe())},se=t=>{const e=b.value.find(s=>s.id===t);b.value=b.value.filter(s=>s.id!==t),e&&!(g.value||[]).some(s=>s.id===e.id)&&(g.value=[...g.value||[],{id:e.id,description:e.description}])},we=()=>{const t=(R.value||[]).slice();if(!t.length)return;const e=new Set((b.value||[]).map(c=>c.id)),s=[],o=new Set;for(const c of t)!c||!c.id||e.has(c.id)||(s.push({id:c.id,description:c.description,status:S.value,priority:z.value,deadline:typeof N.value=="function"?N.value():N.value}),o.add(c.id));s.length&&(b.value=[...b.value,...s]),o.size&&(g.value=(g.value||[]).filter(c=>!o.has(c.id))),xe()},_e=d(null),xe=()=>{try{H(()=>{const t=_e.value;t&&(t.scrollTop=t.scrollHeight)})}catch{}},be=()=>{try{H(()=>{const t=F.value;if(!t||!u.value.assigned_to_id)return;const e=t.querySelector(`[data-user-id="${u.value.assigned_to_id}"]`);e&&typeof e.scrollIntoView=="function"&&e.scrollIntoView({block:"nearest"})})}catch{}},he=t=>{!t||!t.id||(u.value.assigned_to_id=t.id,be())},le=(t,e)=>{t.key==="Enter"&&(u.value.assigned_to_id=e.id,be())},ue=()=>{const t={};return u.value.department_id||(t.department_id="Department is required"),u.value.assigned_to_id||(t.assigned_to_id="Assignee is required"),b.value.length||(t.standards="Select at least one standard"),u.value.academic_year?.trim()||(t.academic_year="Academic year is required"),I.value.length||(t.evaluators="At least one evaluator is required"),h.value=t,Object.keys(t).length===0},K=d(!1),Se=async()=>{if(ue()){K.value=!0;try{const t={academic_year:u.value.academic_year.trim(),semester:u.value.semester||null,assigned_to_id:Number(u.value.assigned_to_id)},e=[];for(const s of b.value){const o={...t,standard_id:Number(s.id),status:s.status||"in_progress",priority:s.priority||"medium",deadline:s.deadline?new Date(s.deadline):null},c=await T.create(o);if(c?.id){if(I.value.length)try{await T.setEvaluators(c.id,I.value.map(Re=>Re.id))}catch{}e.push(c)}}ae("submitted",e),j.value=!1}finally{K.value=!1}}};ce(()=>u.value.department_id,async(t,e)=>{t&&(await Promise.all([oe(),ye()]),C.value=2,await H(),M.value?.focus())}),ce(j,async t=>{t&&(C.value=1,h.value={},b.value=[],Z.value="",X.value=[],u.value.assigned_to_id="",E.value="",g.value=[],G.value="",ee.value=[],I.value=[],(!Array.isArray(L.departments?.data)||!L.departments?.data?.length)&&await L.fetchAll({page:1,limit:100},!0),u.value={department_id:"",assigned_to_id:"",academic_year:"",semester:""},await H(),x.value?.focus())}),De(async()=>{(!Array.isArray(L.departments?.data)||!L.departments?.data?.length)&&await L.fetchAll({page:1,limit:100},!0)}),ce(()=>Z.value,()=>{try{H(()=>{F.value&&(F.value.scrollTop=0)})}catch{}});const $e=async()=>{let t=!1;const e={...h.value};if(u.value.academic_year?.trim()||(e.academic_year="Academic year is required",t=!0),u.value.assigned_to_id||(e.assigned_to_id="Assignee is required",t=!0),h.value=e,t){await H(),u.value.academic_year?.trim()?M.value?.focus():pe.value?.focus();return}C.value=3,await H(),ne.value?.focus()},W=async()=>{if(!b.value.length){h.value={...h.value,standards:"Select at least one standard"};return}C.value=4,await H(),me.value?.focus()},Q=()=>{j.value=!1},G=d(""),A=d(!1),ee=d([]),I=d([]),Ce=async()=>{const t=(G.value||"").trim().toLowerCase(),e=new Set((I.value||[]).map(c=>c.id)),s=(X.value||[]).filter(c=>String(c?.membership?.role||"").toLowerCase()==="evaluator"),o=t?s.filter(c=>String(c.username||"").toLowerCase().includes(t)||String(c.first_name||"").toLowerCase().includes(t)||String(c.last_name||"").toLowerCase().includes(t)):s;ee.value=o.filter(c=>!e.has(c.id)).slice(0,20)},Ae=t=>{!t||!t.id||(I.value.find(e=>e.id===t.id)||I.value.push(t),G.value="",ee.value=[])},n=t=>{I.value=I.value.filter(e=>e.id!==t.id)};return ce(()=>u.value.semester,t=>{try{t!=null&&localStorage.setItem("dasig:lastSemester",String(t))}catch{}}),(t,e)=>(l(),ie(Ue,{name:"fade"},{default:D(()=>[j.value?(l(),i("div",Xe,[a("div",Ze,[a("div",et,[a("div",tt,[e[11]||(e[11]=a("h3",{class:"text-lg font-semibold"},"Evaluation",-1)),a("div",at,[a("span",{class:q(["px-2 py-[2px] rounded-full",C.value>=1?"bg-indigo-50 text-indigo-700 ring-1 ring-indigo-200":"bg-gray-100 text-gray-500"])},"1. Department",2),a("span",{class:q(["px-2 py-[2px] rounded-full",C.value>=2?"bg-indigo-50 text-indigo-700 ring-1 ring-indigo-200":"bg-gray-100 text-gray-500"])},"2. Assignee",2),a("span",{class:q(["px-2 py-[2px] rounded-full",C.value>=3?"bg-indigo-50 text-indigo-700 ring-1 ring-indigo-200":"bg-gray-100 text-gray-500"])},"3. Standards",2),a("span",{class:q(["px-2 py-[2px] rounded-full",C.value>=4?"bg-indigo-50 text-indigo-700 ring-1 ring-indigo-200":"bg-gray-100 text-gray-500"])},"4. Evaluators",2)])]),_(k,{label:"Close",color:"secondary",outline:"",small:"",onClick:Q})]),a("div",st,[a("div",lt,[a("div",null,[e[13]||(e[13]=a("label",{class:"block text-sm mb-1"},"Department",-1)),y(a("select",{ref_key:"deptSelectRef",ref:x,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value.department_id=s),class:"w-full border p-2 rounded"},[e[12]||(e[12]=a("option",{value:""},"-",-1)),(l(!0),i(p,null,f(V(L).departments.data,s=>(l(),i("option",{key:s.id,value:s.id},r(s.name),9,it))),128))],512),[[$,u.value.department_id]]),h.value.department_id?(l(),i("div",nt,r(h.value.department_id),1)):v("",!0)]),a("div",{class:q([C.value>=2?"opacity-100":"opacity-50 pointer-events-none","space-y-2"])},[e[17]||(e[17]=a("label",{class:"block text-sm mb-1"},"Assignee",-1)),y(a("input",{ref_key:"assigneeInputRef",ref:M,"onUpdate:modelValue":e[1]||(e[1]=s=>Z.value=s),placeholder:"Search username or name",class:"w-full border p-2 rounded",onKeydown:Pe(J(()=>{},["prevent"]),["enter"])},null,40,rt),[[te,Z.value]]),a("div",{ref_key:"assigneeListRef",ref:F,class:"border rounded max-h-64 overflow-y-auto mt-2"},[re.value?(l(),i("div",ot,"Loading members…")):(l(),i(p,{key:1},[(l(!0),i(p,null,f(Y.value,s=>(l(),i("div",{key:s.id,"data-user-id":s.id,tabindex:"0",class:"px-2 py-1 text-sm flex items-center justify-between hover:bg-gray-50 focus:bg-gray-50 cursor-pointer",onClick:o=>he(s),onKeydown:o=>le(o,s)},[a("div",ut,"@"+r(s.username)+" — "+r(s.first_name||"")+" "+r(s.last_name||""),1),u.value.assigned_to_id===s.id?(l(),i("span",ct,"Selected")):v("",!0)],40,dt))),128)),Y.value.length?v("",!0):(l(),i("div",vt,"No members"))],64))],512),h.value.assigned_to_id?(l(),i("div",mt,r(h.value.assigned_to_id),1)):v("",!0),a("div",null,[a("div",pt,[a("div",null,[e[14]||(e[14]=a("label",{class:"block text-xs text-gray-600 mb-1"},"A.Y.",-1)),y(a("select",{ref_key:"aySelectRef",ref:pe,"onUpdate:modelValue":e[2]||(e[2]=s=>u.value.academic_year=s),class:"w-full border p-2 rounded"},[(l(!0),i(p,null,f(V(ke),s=>(l(),i("option",{value:s,key:s},r(s),9,gt))),128))],512),[[$,u.value.academic_year]]),h.value.academic_year?(l(),i("div",ft,r(h.value.academic_year),1)):v("",!0)]),a("div",null,[e[16]||(e[16]=a("label",{class:"block text-xs text-gray-600 mb-1"},"Semester",-1)),y(a("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>u.value.semester=s),class:"w-full border p-2 rounded"},[e[15]||(e[15]=a("option",{value:""},"-",-1)),(l(),i(p,null,f(ve,s=>a("option",{key:s,value:s},r(s),9,yt)),64))],512),[[$,u.value.semester]])])])])],2),a("div",_t,[_(k,{small:"",color:"primary",outline:"",disabled:!u.value.academic_year?.trim()||!u.value.assigned_to_id,label:"Next: Standards",onClick:$e},null,8,["disabled"])])]),a("div",{class:q(["xl:col-span-3 grid grid-cols-1 lg:grid-cols-3 gap-4",C.value>=3?"opacity-100":"opacity-50 pointer-events-none"])},[a("div",{class:"border rounded-lg",onDragover:e[5]||(e[5]=J(()=>{},["prevent"])),onDrop:e[6]||(e[6]=J(()=>{U.value?.value?.id&&se(U.value.value.id),U.value.value=null},["prevent"]))},[a("div",xt,[e[18]||(e[18]=a("div",{class:"font-medium text-sm"},"Available Standards",-1)),_(k,{small:"",color:"primary",outline:"",disabled:!R.value.length,label:`Add All (${R.value.length})`,onClick:we},null,8,["disabled","label"])]),a("div",bt,[y(a("input",{ref_key:"standardSearchRef",ref:ne,"onUpdate:modelValue":e[4]||(e[4]=s=>E.value=s),placeholder:"Search standards",class:"w-full border p-2 rounded mb-2"},null,512),[[te,E.value]]),m.value?(l(),i("div",kt,"Loading standards…")):v("",!0),a("div",wt,[(l(!0),i(p,null,f(R.value,s=>(l(),i("div",{key:s.id,draggable:"true",onDragstart:()=>ge(s),class:"py-2 px-2 hover:bg-gray-50 cursor-grab select-none"},[a("div",St,"#"+r(s.id)+" — "+r(s.description),1),a("div",$t,[_(k,{small:"",color:"primary",outline:"",label:"Add",onClick:o=>de(s)},null,8,["onClick"])])],40,ht))),128)),!R.value.length&&!m.value?(l(),i("div",Ct,"No results")):v("",!0)])]),h.value.evaluators||C.value>=4&&!I.value.length?(l(),i("div",At,r(h.value.evaluators||"At least one evaluator is required"),1)):v("",!0)],32),a("div",{class:"lg:col-span-2 border rounded-lg",onDragover:e[9]||(e[9]=J(()=>{},["prevent"])),onDrop:J(fe,["prevent"])},[a("div",Dt,[a("div",Et,"Selected Standards ("+r(b.value.length)+")",1),a("div",Vt,[a("label",Lt,[e[20]||(e[20]=a("span",null,"Default Status",-1)),y(a("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>S.value=s),class:"border rounded px-1 py-[2px] text-xs"},[...e[19]||(e[19]=[a("option",{value:"in_progress"},"in_progress",-1),a("option",{value:"complied"},"complied",-1),a("option",{value:"not_complied"},"not_complied",-1)])],512),[[$,S.value]])]),a("label",Ut,[e[22]||(e[22]=a("span",null,"Default Priority",-1)),y(a("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>z.value=s),class:"border rounded px-1 py-[2px] text-xs"},[...e[21]||(e[21]=[a("option",{value:"low"},"low",-1),a("option",{value:"medium"},"medium",-1),a("option",{value:"high"},"high",-1),a("option",{value:"urgent"},"urgent",-1)])],512),[[$,z.value]])])])]),a("div",It,[a("div",{ref_key:"selectedScrollRef",ref:_e,class:"max-h-80 overflow-y-auto pr-1 grid grid-cols-1 md:grid-cols-2 gap-3"},[(l(!0),i(p,null,f(b.value,s=>(l(),i("div",{key:s.id,class:"border rounded p-2",draggable:"true",onDragstart:()=>ge({id:s.id,description:s.description})},[a("div",Nt,"#"+r(s.id)+" — "+r(s.description),1),a("div",Tt,[a("label",Rt,[e[24]||(e[24]=P("Status ",-1)),y(a("select",{"onUpdate:modelValue":o=>s.status=o,class:"w-full border rounded p-1 text-xs"},[...e[23]||(e[23]=[a("option",{value:"in_progress"},"in_progress",-1),a("option",{value:"complied"},"complied",-1),a("option",{value:"not_complied"},"not_complied",-1)])],8,Pt),[[$,s.status]])]),a("label",jt,[e[26]||(e[26]=P("Priority ",-1)),y(a("select",{"onUpdate:modelValue":o=>s.priority=o,class:"w-full border rounded p-1 text-xs"},[...e[25]||(e[25]=[a("option",{value:"low"},"low",-1),a("option",{value:"medium"},"medium",-1),a("option",{value:"high"},"high",-1),a("option",{value:"urgent"},"urgent",-1)])],8,qt),[[$,s.priority]])]),a("label",Ot,[e[27]||(e[27]=P("Deadline ",-1)),y(a("input",{type:"date","onUpdate:modelValue":o=>s.deadline=o,class:"w-full border rounded p-1 text-xs"},null,8,Bt),[[te,s.deadline]])])]),a("div",Ft,[_(k,{small:"",color:"secondary",outline:"",label:"Remove",onClick:o=>se(s.id)},null,8,["onClick"])])],40,Mt))),128))],512),h.value.standards?(l(),i("div",Yt,r(h.value.standards),1)):v("",!0),b.value.length?v("",!0):(l(),i("div",zt," Drag standards here or click Add")),a("div",Kt,[_(k,{small:"",color:"primary",outline:"",disabled:!b.value.length,label:"Next: Evaluators",onClick:W},null,8,["disabled"])])])],32)],2)]),a("div",{class:q(["px-4 sm:px-6 pb-4",C.value>=4?"opacity-100":"opacity-50 pointer-events-none"])},[a("div",Wt,[e[28]||(e[28]=a("div",{class:"px-3 py-2 border-b font-medium text-sm"},"Evaluators (required)",-1)),a("div",Qt,[y(a("input",{ref_key:"evaluatorInputRef",ref:me,"onUpdate:modelValue":e[10]||(e[10]=s=>G.value=s),onInput:Ce,class:"w-full border p-2 rounded",placeholder:"Search users by username"},null,544),[[te,G.value]]),G.value?(l(),i("div",Gt,[A.value?(l(),i("div",Ht,"Searching...")):(l(),i(p,{key:1},[(l(!0),i(p,null,f(ee.value,s=>(l(),i("div",{key:s.id,class:"p-2 text-sm flex items-center justify-between hover:bg-gray-50"},[a("div",Jt,"@"+r(s.username)+" — "+r(s.first_name||"")+" "+r(s.last_name||""),1),_(k,{small:"",color:"primary",outline:"",label:"Add",onClick:o=>Ae(s)},null,8,["onClick"])]))),128)),ee.value.length?v("",!0):(l(),i("div",Xt,"No results"))],64))])):v("",!0),a("div",Zt,[(l(!0),i(p,null,f(I.value,s=>(l(),i("span",{key:s.id,class:"inline-flex items-center rounded-full bg-indigo-50 px-2 py-[2px] text-[11px] text-indigo-700 ring-1 ring-indigo-200"},[P(" @"+r(s.username)+" ",1),a("button",{class:"ml-1 text-indigo-600 hover:text-indigo-800",onClick:J(o=>n(s),["prevent"])},"×",8,ea)]))),128))])])])],2),a("div",ta,[e[29]||(e[29]=a("div",{class:"text-xs text-gray-500"},"Tip: Department → Assignee → Standards → Evaluators. Drag items to the right to select.",-1)),a("div",aa,[_(k,{color:"secondary",outline:"",label:"Cancel",onClick:Q}),_(k,{disabled:K.value,label:K.value?"Creating…":`Create ${b.value.length||""}`,color:"primary",onClick:Se},null,8,["disabled","label"])])])])])):v("",!0)]),_:1}))}},la=Te(sa,[["__scopeId","data-v-28e32478"]]),ia={class:"mb-3 flex items-center justify-between"},na={class:"flex items-center gap-2"},ra={class:"flex items-center gap-2"},oa={class:"rounded-2xl border bg-white shadow-sm mb-3 p-4"},da={class:"grid grid-cols-1 md:grid-cols-6 gap-3"},ua=["value"],ca=["value"],va=["disabled"],ma=["value"],pa=["value"],ga=["value"],fa=["value"],ya=["value"],_a={class:"md:col-span-6 flex justify-end"},xa={class:"text-sm text-gray-900"},ba={key:0,class:"text-xs text-gray-500 line-clamp-2"},ka={class:"text-xs text-gray-700 flex items-center gap-2"},wa={class:"text-[11px] text-gray-500"},ha={class:"text-xs"},Sa={class:"text-[11px] text-gray-500"},$a={class:"text-xs"},Ca={class:"text-xs"},Aa={class:"flex justify-end gap-1"},Da={key:0,class:"fixed inset-0 bg-black/30 z-50 grid place-items-center"},Ea={class:"bg-white rounded-2xl shadow-xl w-full max-w-5xl"},Va={class:"px-4 sm:px-6 py-3 border-b flex items-center justify-between"},La={class:"text-lg font-semibold"},Ua={class:"p-4 sm:p-6 space-y-3 max-h-[70vh] overflow-y-auto"},Ia={class:"grid grid-cols-1 gap-3"},Ma={key:0},Na=["disabled"],Ta=["value"],Ra={key:0,class:"text-xs text-red-600"},Pa={key:1},ja=["disabled"],qa=["value"],Oa={key:2},Ba={class:"flex items-center gap-2 mb-2"},Fa={class:"max-h-40 overflow-auto border rounded"},Ya={key:0,class:"p-2 text-xs text-gray-500"},za={key:1},Ka={class:"truncate"},Wa={key:0,class:"p-2 text-xs text-gray-500"},Qa={class:"flex flex-wrap gap-2 mt-2"},Ga=["onClick"],Ha={key:0,class:"text-xs text-red-600"},Ja={key:3,class:"border rounded p-2"},Xa={key:0},Za={class:"md:col-span-1 whitespace-normal break-words"},es=["onUpdate:modelValue"],ts=["value"],as=["onUpdate:modelValue"],ss=["value"],ls=["onUpdate:modelValue"],is={key:0,class:"text-right"},ns={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-2"},rs=["value"],os={key:0,class:"text-xs text-red-600"},ds=["value"],us={class:"flex gap-2 mb-2"},cs={key:0,class:"max-h-36 overflow-auto border rounded mb-2"},vs={key:0,class:"p-2 text-xs text-gray-500"},ms={key:1},ps={class:"truncate"},gs={key:0,class:"p-2 text-xs text-gray-500"},fs={class:"flex flex-wrap gap-2"},ys=["onClick"],_s={class:"pt-2 flex justify-end"},xs={__name:"EvaluationsManagementPage",setup(Ee){const w=Ie(),B=Me(),ae=je(),T=O(()=>String(ae.user?.role||"").toLowerCase()==="admin"),L=d([]),j=O(()=>{const n=new Map;return(L.value||[]).forEach(t=>{const e=String(t?.membership?.role||t?.UserDepartment?.role||t?.user_department?.role||"").toLowerCase();t?.id&&n.set(Number(t.id),e)}),n}),ke=O(()=>T.value||(L.value||[]).some(n=>String(n?.membership?.role||"").toLowerCase()==="supervisor")),ve=["in_progress","complied","not_complied"],u=["low","medium","high","urgent"],h=["1st Semester","2nd Semester","Summer"],C=(()=>{const n=new Date().getFullYear();return Array.from({length:6},(t,e)=>`${n+e}-${n+e+1}`)})(),x=d({page:1,limit:10,department_id:"",assigned_to_id:"",status:"",priority:"",academic_year:"",semester:""}),M=async(n={},t=!0)=>{x.value={...x.value,...n};const e={...x.value};["department_id","assigned_to_id","status","priority","academic_year","semester"].forEach(s=>{(e[s]===""||e[s]==null)&&delete e[s]}),await w.fetchAll(e,t)};De(async()=>{if(await B.fetchAll({page:1,limit:100},!0),!T.value&&ae.user?.id)try{L.value=await Oe.getDepartments(ae.user.id)}catch{}await M({page:1,limit:10},!0)});const F=d([]),ne=d(!1),me=async()=>{if(F.value=[],!!x.value.department_id){ne.value=!0;try{const n=await B.fetchMembers(x.value.department_id,!0);F.value=Array.isArray(n)?n:[]}finally{ne.value=!1}}};ce(()=>x.value.department_id,async()=>{x.value.assigned_to_id="",await me()});const pe=O(()=>({total:w.list.total||0,totalPages:w.list.totalPages||1,currentPage:w.list.currentPage||1,pageSize:w.list.pageSize||10,data:w.list.data||[]})),X=[{key:"standard",label:"Standard",sortable:!1,minWidth:260},{key:"status",label:"Status",sortable:!0,width:100},{key:"priority",label:"Priority",sortable:!0,width:100},{key:"acad",label:"A.Y./Sem",sortable:!1,width:140},{key:"assignee",label:"Assignee",sortable:!1,minWidth:180},{key:"deadline",label:"Deadline",sortable:!0,width:140}],re=n=>B.departments?.data?.find(e=>e.id===n)?.name||"-",Z=n=>{const t=String(n||"").toLowerCase();return t==="governance"?"bg-indigo-50 text-indigo-700 ring-indigo-200":t==="records"?"bg-amber-50 text-amber-700 ring-amber-200":t==="processes"?"bg-sky-50 text-sky-700 ring-sky-200":t==="quality"?"bg-emerald-50 text-emerald-700 ring-emerald-200":t==="resources"?"bg-purple-50 text-purple-700 ring-purple-200":"bg-gray-50 text-gray-700 ring-gray-200"},Y=d(!1),g=d("create"),m=d({id:null,standard_id:"",department_id:"",academic_year:"",semester:"",assigned_to_id:""}),E=d({}),R=d([]),b=O(()=>{const n=String(N.value||"").toLowerCase(),t=new Set((S.value||[]).map(s=>s.id)),e=(R.value||[]).filter(s=>!t.has(s.id));return n?e.filter(s=>String(s.description||"").toLowerCase().includes(n)||String(s.id).includes(n)):e}),S=d([]),z=d(!1),N=d(""),U=d([]),ge=O(()=>(U.value||[]).filter(n=>String(n?.membership?.role||"").toLowerCase()==="member")),fe=d(!1),oe=async()=>{if(R.value=[],!!m.value.department_id){z.value=!0;try{const n=await Ne.list({department_id:m.value.department_id,limit:100});R.value=Array.isArray(n?.data)?n.data:[]}finally{z.value=!1}}},ye=n=>{!n||!n.id||S.value.find(t=>t.id===n.id)||S.value.push({id:n.id,description:n.description,status:"in_progress",priority:"medium",deadline:(()=>{const t=new Date;t.setDate(t.getDate()+1);const e=s=>String(s).padStart(2,"0");return`${t.getFullYear()}-${e(t.getMonth()+1)}-${e(t.getDate())}`})()})},de=n=>{S.value=S.value.filter(t=>t.id!==n)},se=async()=>{if(U.value=[],!!m.value.department_id){fe.value=!0;try{const n=await B.fetchMembers(m.value.department_id,!0);U.value=Array.isArray(n)?n:[]}finally{fe.value=!1}}},we=async()=>{g.value="create",m.value={id:null,standard_id:"",department_id:"",academic_year:"",semester:"",assigned_to_id:""},E.value={},Y.value=!0,A.value=[],W.value="",Q.value=[],S.value=[],U.value=[],R.value=[],N.value="",await oe(),await se()},_e=async n=>{if(!T.value&&j.value.get(Number(n.department_id))!=="supervisor")return;await w.fetchById(n.id);const t=w.selected||n;g.value="edit",m.value={id:t.id,standard_id:t.standard_id,department_id:t.department_id,academic_year:t.academic_year||C[0]||"",semester:t.semester||"",assigned_to_id:t.assigned_to_id||""},E.value={},Y.value=!0,S.value=[{id:t.standard_id,description:t.standard?.description||"",status:t.status,priority:t.priority,deadline:t.deadline?new Date(t.deadline).toISOString().slice(0,10):""}],await oe(),await se(),await Ae(t.id)},xe=()=>{const n={};return m.value.department_id||(n.department_id="Department is required"),!S.value.length&&!m.value.standard_id&&(n.standard_id="At least one standard is required"),m.value.academic_year?.trim()||(n.academic_year="Academic year is required"),E.value=n,Object.keys(n).length===0},be=async()=>{if(!xe())return;const n={academic_year:m.value.academic_year.trim(),semester:m.value.semester||null,assigned_to_id:m.value.assigned_to_id?Number(m.value.assigned_to_id):null};if(g.value==="create"){const t=S.value.length?S.value:m.value.standard_id?[{id:Number(m.value.standard_id),status:"in_progress",priority:"medium",deadline:(()=>{const s=new Date;s.setDate(s.getDate()+1);const o=c=>String(c).padStart(2,"0");return`${s.getFullYear()}-${o(s.getMonth()+1)}-${o(s.getDate())}`})()}]:[],e=[];for(const s of t){const o=await w.create({...n,status:s.status||"in_progress",priority:s.priority||"medium",deadline:s.deadline?new Date(s.deadline):(function(){const c=new Date;return c.setDate(c.getDate()+1),c})(),standard_id:Number(s.id)});o?.id&&(e.push(o.id),A.value.length&&await w.setEvaluators(o.id,A.value.map(c=>c.id)))}}else{const t=S.value[0]||{id:m.value.standard_id,status:"in_progress",priority:"medium",deadline:null},e=await w.updateById(m.value.id,{...n,status:t.status||"in_progress",priority:t.priority||"medium",deadline:t.deadline?new Date(t.deadline):(function(){const s=new Date;return s.setDate(s.getDate()+1),s})(),standard_id:Number(t.id)});A.value.length&&e?.id&&await w.setEvaluators(e.id,A.value.map(s=>s.id))}Y.value=!1,await M({},!0)},he=async n=>{!T.value&&j.value.get(Number(n.department_id))!=="supervisor"||!(await Ve.fire({title:"Delete evaluation?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Delete"})).isConfirmed||(await w.deleteById(n.id),await M({},!0),await Ve.fire("Deleted","Evaluation removed.","success"))},le=d(!1),ue=d(!1),K=()=>{try{ue.value=window.matchMedia("(min-width: 1024px)").matches}catch{ue.value=!0}};De(()=>{K(),window.addEventListener("resize",K)}),qe(()=>{window.removeEventListener("resize",K)});const Se=()=>{ue.value?le.value=!0:we()},$e=async()=>{le.value=!1,await M({},!0)},W=d(""),Q=d([]),G=d(!1),A=d([]),ee=async()=>{const n=(W.value||"").trim().toLowerCase(),t=new Set((A.value||[]).map(o=>o.id)),e=(U.value||[]).filter(o=>String(o?.membership?.role||"").toLowerCase()==="evaluator"),s=n?e.filter(o=>String(o.username||"").toLowerCase().includes(n)||String(o.first_name||"").toLowerCase().includes(n)||String(o.last_name||"").toLowerCase().includes(n)):e;Q.value=s.filter(o=>!t.has(o.id)).slice(0,20)},I=n=>{!n||!n.id||(A.value.find(t=>t.id===n.id)||A.value.push(n),W.value="",Q.value=[])},Ce=n=>{A.value=A.value.filter(t=>t.id!==n.id)},Ae=async n=>{try{const t=await w.fetchEvaluators(n);A.value=Array.isArray(t)?t:[]}catch{A.value=[]}};return(n,t)=>(l(),ie(Be,null,{default:D(()=>[_(Fe,null,{default:D(()=>[_(Ge,{icon:V(Ye),title:"Evaluations",main:""},{default:D(()=>[...t[19]||(t[19]=[P(" Track and assign compliance evaluations ",-1)])]),_:1},8,["icon"]),a("div",ia,[a("div",na,[ke.value?(l(),ie(k,{key:0,icon:V(ze),color:"primary",label:"New Evaluation",onClick:Se},null,8,["icon"])):v("",!0)]),a("div",ra,[_(k,{icon:V(Ke),color:"info",label:"Refresh",onClick:t[0]||(t[0]=()=>M({},!0))},null,8,["icon"])])]),V(w).error?(l(),ie(He,{key:0,color:"danger"},{default:D(()=>[P(r(V(w).error),1)]),_:1})):v("",!0),a("div",oa,[a("div",da,[a("div",null,[t[21]||(t[21]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Department",-1)),y(a("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>x.value.department_id=e),class:"w-full border p-2 rounded"},[t[20]||(t[20]=a("option",{value:""},"All",-1)),T.value?(l(!0),i(p,{key:0},f(V(B).departments.data,e=>(l(),i("option",{key:e.id,value:e.id},r(e.name),9,ua))),128)):(l(!0),i(p,{key:1},f(L.value,e=>(l(),i("option",{key:e.id,value:e.id},r(e.name),9,ca))),128))],512),[[$,x.value.department_id]])]),a("div",null,[t[23]||(t[23]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Assignee",-1)),y(a("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>x.value.assigned_to_id=e),class:"w-full border p-2 rounded",disabled:!x.value.department_id},[t[22]||(t[22]=a("option",{value:""},"All",-1)),(l(!0),i(p,null,f(F.value,e=>(l(),i("option",{key:e.id,value:e.id},"@"+r(e.username)+" "+r(e.first_name||"")+" "+r(e.last_name||""),9,ma))),128))],8,va),[[$,x.value.assigned_to_id]])]),a("div",null,[t[25]||(t[25]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Status",-1)),y(a("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>x.value.status=e),class:"w-full border p-2 rounded"},[t[24]||(t[24]=a("option",{value:""},"All",-1)),(l(),i(p,null,f(ve,e=>a("option",{key:e,value:e},r(e),9,pa)),64))],512),[[$,x.value.status]])]),a("div",null,[t[27]||(t[27]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Priority",-1)),y(a("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>x.value.priority=e),class:"w-full border p-2 rounded"},[t[26]||(t[26]=a("option",{value:""},"All",-1)),(l(),i(p,null,f(u,e=>a("option",{key:e,value:e},r(e),9,ga)),64))],512),[[$,x.value.priority]])]),a("div",null,[t[29]||(t[29]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"A.Y.",-1)),y(a("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>x.value.academic_year=e),class:"w-full border p-2 rounded"},[t[28]||(t[28]=a("option",{value:""},"All",-1)),(l(!0),i(p,null,f(V(C),e=>(l(),i("option",{key:e,value:e},r(e),9,fa))),128))],512),[[$,x.value.academic_year]])]),a("div",null,[t[31]||(t[31]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Semester",-1)),y(a("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>x.value.semester=e),class:"w-full border p-2 rounded"},[t[30]||(t[30]=a("option",{value:""},"All",-1)),(l(),i(p,null,f(h,e=>a("option",{key:e,value:e},r(e),9,ya)),64))],512),[[$,x.value.semester]])]),a("div",_a,[_(k,{color:"primary",label:"Apply",onClick:t[7]||(t[7]=()=>M({page:1},!0))})])])]),_(Je,{columns:X,data:pe.value,loading:V(w).isLoading,onQueryChange:t[8]||(t[8]=e=>M(e,!0))},{"cell-title":D(({row:e})=>[a("div",xa,r(e.title||"(no title)"),1),e.description?(l(),i("div",ba,r(e.description),1)):v("",!0)]),"cell-standard":D(({row:e})=>[a("div",ka,[a("span",null,"#"+r(e.standard_id)+" - "+r(e.standard?.description||"-"),1),e.standard?.area?(l(),i("span",{key:0,class:q(["inline-flex items-center rounded-full px-2 py-[2px] text-[11px] ring-1",Z(e.standard.area)])},r(e.standard.area),3)):v("",!0)]),a("div",wa,"Dept: "+r(re(e.department_id)),1)]),"cell-status":D(({row:e})=>[_(Le,{text:e.status,tone:e.status==="complied"?"emerald":e.status==="in_progress"?"indigo":"gray"},null,8,["text","tone"])]),"cell-priority":D(({row:e})=>[_(Le,{text:e.priority,tone:e.priority==="high"||e.priority==="urgent"?"orange":"gray"},null,8,["text","tone"])]),"cell-acad":D(({row:e})=>[a("div",ha,r(e.academic_year||"-"),1),a("div",Sa,r(e.semester||""),1)]),"cell-assignee":D(({row:e})=>[a("div",$a,r(e.assignee?"@"+e.assignee.username:"-"),1)]),"cell-deadline":D(({row:e})=>[a("div",Ca,r(e.deadline?new Date(e.deadline).toLocaleDateString():"-"),1)]),"cell-actions":D(({row:e})=>[a("div",Aa,[T.value||j.value.get(Number(e.department_id))==="supervisor"?(l(),ie(k,{key:0,icon:V(We),small:"",color:"secondary",outline:"",onClick:s=>_e(e)},null,8,["icon","onClick"])):v("",!0),T.value||j.value.get(Number(e.department_id))==="supervisor"?(l(),ie(k,{key:1,icon:V(Qe),small:"",color:"danger",outline:"",onClick:s=>he(e)},null,8,["icon","onClick"])):v("",!0)])]),default:D(()=>[t[32]||(t[32]=a("div",{class:"hidden"},[a("span",{class:"bg-indigo-50 text-indigo-700 ring-indigo-200"}),a("span",{class:"bg-amber-50 text-amber-700 ring-amber-200"}),a("span",{class:"bg-sky-50 text-sky-700 ring-sky-200"}),a("span",{class:"bg-emerald-50 text-emerald-700 ring-emerald-200"}),a("span",{class:"bg-purple-50 text-purple-700 ring-purple-200"}),a("span",{class:"bg-gray-50 text-gray-700 ring-gray-200"})],-1))]),_:1},8,["data","loading"]),_(Ue,{name:"fade"},{default:D(()=>[Y.value?(l(),i("div",Da,[a("div",Ea,[a("div",Va,[a("h3",La,r(g.value==="create"?"Create Evaluation":"Edit Evaluation"),1),_(k,{label:"Close",color:"secondary",outline:"",small:"",onClick:t[9]||(t[9]=e=>Y.value=!1)})]),a("div",Ua,[a("div",Ia,[g.value==="create"?(l(),i("div",Ma,[t[34]||(t[34]=a("label",{class:"block text-sm mb-1"},"Department",-1)),y(a("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>m.value.department_id=e),class:"w-full border p-2 rounded",disabled:g.value==="edit",onChange:t[11]||(t[11]=()=>{oe(),se()})},[t[33]||(t[33]=a("option",{value:""},"-",-1)),(l(!0),i(p,null,f(V(B).departments.data,e=>(l(),i("option",{key:e.id,value:e.id},r(e.name),9,Ta))),128))],40,Na),[[$,m.value.department_id]]),E.value.department_id?(l(),i("div",Ra,r(E.value.department_id),1)):v("",!0)])):v("",!0),g.value==="create"?(l(),i("div",Pa,[t[36]||(t[36]=a("label",{class:"block text-sm mb-1"},"Assignee",-1)),y(a("select",{"onUpdate:modelValue":t[12]||(t[12]=e=>m.value.assigned_to_id=e),class:"w-full border p-2 rounded",disabled:g.value==="edit"},[t[35]||(t[35]=a("option",{value:""},"-",-1)),(l(!0),i(p,null,f(ge.value,e=>(l(),i("option",{key:e.id,value:e.id},"@"+r(e.username)+" "+r(e.first_name||"")+" "+r(e.last_name||""),9,qa))),128))],8,ja),[[$,m.value.assigned_to_id]])])):v("",!0),g.value==="create"?(l(),i("div",Oa,[t[37]||(t[37]=a("label",{class:"block text-sm mb-1"},[P("Standards "),a("span",{class:"text-red-500"},"*")],-1)),a("div",Ba,[y(a("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>N.value=e),class:"flex-1 border p-2 rounded",placeholder:"Search standards..."},null,512),[[te,N.value]]),_(k,{small:"",color:"primary",outline:"",label:"Add All",onClick:t[14]||(t[14]=()=>{b.value.forEach(ye)})})]),a("div",Fa,[z.value?(l(),i("div",Ya,"Loading...")):(l(),i("div",za,[(l(!0),i(p,null,f(b.value,e=>(l(),i("div",{key:e.id,class:"p-2 text-sm flex items-center justify-between hover:bg-gray-50"},[a("div",Ka,"#"+r(e.id)+" "+r(e.description),1),_(k,{small:"",color:"primary",outline:"",label:"Add",onClick:s=>ye(e)},null,8,["onClick"])]))),128)),b.value.length?v("",!0):(l(),i("div",Wa,"No standards"))]))]),a("div",Qa,[(l(!0),i(p,null,f(S.value,e=>(l(),i("span",{key:e.id,class:"inline-flex items-center rounded-full bg-blue-50 px-2 py-[2px] text-[11px] text-blue-700 ring-1 ring-blue-200"},[P(" #"+r(e.id)+" ",1),a("button",{class:"ml-1 text-blue-700 hover:text-blue-900",onClick:J(s=>de(e.id),["prevent"])},"×",8,Ga)]))),128))]),E.value.standard_id?(l(),i("div",Ha,r(E.value.standard_id),1)):v("",!0)])):v("",!0),S.value.length?(l(),i("div",Ja,[t[42]||(t[42]=a("div",{class:"text-xs font-medium text-gray-700 mb-2"},"Per-standard settings",-1)),a("div",{class:q(["grid grid-cols-1 gap-2 text-xs",g.value==="create"?"md:grid-cols-5":"md:grid-cols-4"])},[t[38]||(t[38]=a("div",{class:"font-semibold"},"Standard",-1)),t[39]||(t[39]=a("div",{class:"font-semibold"},"Status",-1)),t[40]||(t[40]=a("div",{class:"font-semibold"},"Priority",-1)),t[41]||(t[41]=a("div",{class:"font-semibold"},"Deadline",-1)),g.value==="create"?(l(),i("div",Xa)):v("",!0),(l(!0),i(p,null,f(S.value,(e,s)=>(l(),i(p,{key:e.id},[a("div",Za,"#"+r(e.id)+" "+r(e.description||""),1),a("div",null,[y(a("select",{"onUpdate:modelValue":o=>e.status=o,class:"w-full border p-1 rounded"},[(l(),i(p,null,f(ve,o=>a("option",{key:o,value:o},r(o),9,ts)),64))],8,es),[[$,e.status]])]),a("div",null,[y(a("select",{"onUpdate:modelValue":o=>e.priority=o,class:"w-full border p-1 rounded"},[(l(),i(p,null,f(u,o=>a("option",{key:o,value:o},r(o),9,ss)),64))],8,as),[[$,e.priority]])]),a("div",null,[y(a("input",{type:"date","onUpdate:modelValue":o=>e.deadline=o,class:"w-full border p-1 rounded"},null,8,ls),[[te,e.deadline]])]),g.value==="create"?(l(),i("div",is,[_(k,{small:"",color:"danger",outline:"",label:"Remove",onClick:o=>de(e.id)},null,8,["onClick"])])):v("",!0)],64))),128))],2)])):v("",!0)]),a("div",ns,[a("div",null,[t[43]||(t[43]=a("label",{class:"block text-sm mb-1"},[P("Academic Year "),a("span",{class:"text-red-500"},"*")],-1)),y(a("select",{"onUpdate:modelValue":t[15]||(t[15]=e=>m.value.academic_year=e),class:"w-full border p-2 rounded"},[(l(!0),i(p,null,f(V(C),e=>(l(),i("option",{key:e,value:e},r(e),9,rs))),128))],512),[[$,m.value.academic_year]]),E.value.academic_year?(l(),i("div",os,r(E.value.academic_year),1)):v("",!0)]),a("div",null,[t[45]||(t[45]=a("label",{class:"block text-sm mb-1"},"Semester",-1)),y(a("select",{"onUpdate:modelValue":t[16]||(t[16]=e=>m.value.semester=e),class:"w-full border p-2 rounded"},[t[44]||(t[44]=a("option",{value:""},"-",-1)),(l(),i(p,null,f(h,e=>a("option",{key:e,value:e},r(e),9,ds)),64))],512),[[$,m.value.semester]])])]),a("div",null,[t[46]||(t[46]=a("label",{class:"block text-sm mb-1"},"Evaluators (multi)",-1)),a("div",us,[y(a("input",{"onUpdate:modelValue":t[17]||(t[17]=e=>W.value=e),onInput:ee,class:"flex-1 border p-2 rounded",placeholder:"Search users by username"},null,544),[[te,W.value]])]),W.value?(l(),i("div",cs,[G.value?(l(),i("div",vs,"Searching...")):(l(),i("div",ms,[(l(!0),i(p,null,f(Q.value,e=>(l(),i("div",{key:e.id,class:"p-2 text-sm flex items-center justify-between hover:bg-gray-50"},[a("div",ps,"@"+r(e.username)+" "+r(e.first_name||"")+" "+r(e.last_name||""),1),_(k,{small:"",color:"primary",outline:"",label:"Add",onClick:s=>I(e)},null,8,["onClick"])]))),128)),Q.value.length?v("",!0):(l(),i("div",gs,"No results"))]))])):v("",!0),a("div",fs,[(l(!0),i(p,null,f(A.value,e=>(l(),i("span",{key:e.id,class:"inline-flex items-center rounded-full bg-indigo-50 px-2 py-[2px] text-[11px] text-indigo-700 ring-1 ring-indigo-200"},[P(" @"+r(e.username)+" ",1),a("button",{class:"ml-1 text-indigo-600 hover:text-indigo-800",onClick:J(s=>Ce(e),["prevent"])},null,8,ys)]))),128))])]),a("div",_s,[_(k,{color:"primary",label:g.value==="create"?"Create":"Save Changes",onClick:be},null,8,["label"])])])])])):v("",!0)]),_:1}),_(la,{modelValue:le.value,"onUpdate:modelValue":t[18]||(t[18]=e=>le.value=e),onSubmitted:$e},null,8,["modelValue"])]),_:1})]),_:1}))}},Vs=Te(xs,[["__scopeId","data-v-53105940"]]);export{Vs as default};

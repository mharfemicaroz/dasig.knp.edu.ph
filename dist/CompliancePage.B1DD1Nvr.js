import{z as q,J as yt,K as bt,r as w,o as je,y as xt,L as ht,M as _t,N as Ue,n as Be,c as S,B as R,b as r,O as ce,l as B,P as ye,I as kt,u as St,s as Ct,A as wt,m as ue,q as Dt,f as Y,e as a,a as d,h,k as N,j as T,t as g,F as U,C as z,g as J,D as ne,w as Oe,v as At,S as H}from"./index.BOknro1r.js";import{_ as Lt,S as Et,c as Mt,w as Vt,x as It,g as Nt,y as Ut,h as Bt}from"./SectionMain.B3hG14Sc.js";import{_ as W}from"./BaseButton.w6EMXcGq.js";import{_ as be}from"./Badge.D_Oe_-0y.js";import{_ as Pe}from"./NotificationBar.CM5Y_e5H.js";import{u as Ot}from"./department.CLvmAIIQ.js";import{u as Pt}from"./evaluation.DYmDG4Ud.js";import{_ as $t}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./BaseIcon.D7Rla7cl.js";import"./ToasterComponent.Dz5A3hFA.js";var Rt=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],Tt=function(i){return Rt.map(function(o){return o.toLowerCase()}).indexOf(i.toLowerCase())!==-1},Ft=function(i,o,l){Object.keys(o).filter(Tt).forEach(function(v){var b=o[v];typeof b=="function"&&(v==="onInit"?b(i,l):l.on(v.substring(2),function(f){return b(f,l)}))})},jt=function(i,o,l,v){var b=i.modelEvents?i.modelEvents:null,f=Array.isArray(b)?b.join(" "):b;q(v,function(_,E){l&&typeof _=="string"&&_!==E&&_!==l.getContent({format:i.outputFormat})&&l.setContent(_)}),l.on(f||"change input undo redo",function(){o.emit("update:modelValue",l.getContent({format:i.outputFormat}))})},zt=function(i,o,l,v,b,f){v.setContent(f()),l.attrs["onUpdate:modelValue"]&&jt(o,l,v,b),Ft(i,l.attrs,v)},$e=0,ze=function(i){var o=Date.now(),l=Math.floor(Math.random()*1e9);return $e++,i+"_"+l+$e+String(o)},Ht=function(i){return i!==null&&i.tagName.toLowerCase()==="textarea"},Re=function(i){return typeof i>"u"||i===""?[]:Array.isArray(i)?i:i.split(" ")},Kt=function(i,o){return Re(i).concat(Re(o))},Xt=function(i){return i==null},Te=function(i){var o;return typeof((o=i.options)===null||o===void 0?void 0:o.set)=="function"&&i.options.isRegistered("disabled")},Fe=function(){return{listeners:[],scriptId:ze("tiny-script"),scriptLoaded:!1}},Yt=function(){var i=Fe(),o=function(b,f,_,E){var m=f.createElement("script");m.referrerPolicy="origin",m.type="application/javascript",m.id=b,m.src=_;var p=function(){m.removeEventListener("load",p),E()};m.addEventListener("load",p),f.head&&f.head.appendChild(m)},l=function(b,f,_){i.scriptLoaded?_():(i.listeners.push(_),b.getElementById(i.scriptId)||o(i.scriptId,b,f,function(){i.listeners.forEach(function(E){return E()}),i.scriptLoaded=!0}))},v=function(){i=Fe()};return{load:l,reinitialize:v}},Wt=Yt(),qt=function(){return typeof window<"u"?window:global},Q=function(){var i=qt();return i&&i.tinymce?i.tinymce:null},Gt={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,readonly:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(i){return i==="html"||i==="text"}}},K=function(){return K=Object.assign||function(i){for(var o,l=1,v=arguments.length;l<v;l++){o=arguments[l];for(var b in o)Object.prototype.hasOwnProperty.call(o,b)&&(i[b]=o[b])}return i},K.apply(this,arguments)},Jt=function(i,o,l,v){return i(v||"div",{id:o,ref:l})},Qt=function(i,o,l){return i("textarea",{id:o,visibility:"hidden",ref:l})},xe={selector:void 0,target:void 0},he=function(i,o){var l;typeof((l=i.mode)===null||l===void 0?void 0:l.set)=="function"?i.mode.set(o):i.setMode(o)},Zt=yt({props:Gt,setup:function(i,o){var l=i.init?K(K({},i.init),xe):K({},xe),v=bt(i),b=v.disabled,f=v.readonly,_=v.modelValue,E=v.tagName,m=w(null),p=null,$=i.id||ze("tiny-vue"),G=i.init&&i.init.inline||i.inline,x=!!o.attrs["onUpdate:modelValue"],C=!0,D=i.initialValue?i.initialValue:"",I="",O=function(k){return x?function(){return _?.value?_.value:""}:function(){return k?D:I}},X=function(){var k=O(C),V=K(K({},l),{disabled:i.disabled,readonly:i.readonly,target:m.value,plugins:Kt(l.plugins,i.plugins),toolbar:i.toolbar||l.toolbar,inline:G,license_key:i.licenseKey,setup:function(F){p=F,!Te(p)&&i.disabled===!0&&he(p,"readonly"),F.on("init",function(A){return zt(A,i,o,F,_,k)}),typeof l.setup=="function"&&l.setup(F)}});Ht(m.value)&&(m.value.style.visibility=""),Q().init(V),C=!1};q(f,function(k){p!==null&&he(p,k?"readonly":"design")}),q(b,function(k){p!==null&&(Te(p)?p.options.set("disabled",k):he(p,k?"readonly":"design"))}),q(E,function(k){var V;p&&(x||(I=p.getContent()),(V=Q())===null||V===void 0||V.remove(p),Be(function(){return X()}))}),je(function(){if(Q()!==null)X();else if(m.value&&m.value.ownerDocument){var k=i.cloudChannel?i.cloudChannel:"8",V=i.apiKey?i.apiKey:"no-api-key",F=Xt(i.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(V,"/tinymce/").concat(k,"/tinymce.min.js"):i.tinymceScriptSrc;Wt.load(m.value.ownerDocument,F,X)}}),xt(function(){Q()!==null&&Q().remove(p)}),G||(ht(function(){C||X()}),_t(function(){var k;p&&(x||(I=p.getContent()),(k=Q())===null||k===void 0||k.remove(p))}));var me=function(k){var V;p&&(I=p.getContent(),(V=Q())===null||V===void 0||V.remove(p),l=K(K(K({},l),k),xe),Be(function(){return X()}))};return o.expose({rerender:me,getEditor:function(){return p}}),function(){return G?Jt(Ue,$,m,i.tagName):Qt(Ue,$,m)}}});const _e={__name:"TinyEditor",props:{id:{type:String,default:void 0},modelValue:{type:String,default:""},placeholder:{type:String,default:""},height:{type:[Number,String],default:180},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,{emit:o}){const l=i,v=o,b=S({get:()=>l.modelValue,set:_=>v("update:modelValue",_)}),f={menubar:!1,plugins:"lists link fullscreen table code autoresize",toolbar:"undo redo | bold italic underline | bullist numlist | link | alignleft aligncenter alignright | table | code | fullscreen",branding:!1,statusbar:!1,autoresize_bottom_margin:16,placeholder:l.placeholder,license_key:"gpl",content_style:"body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; font-size: 14px; }"};return(_,E)=>(r(),R(B(Zt),{modelValue:b.value,"onUpdate:modelValue":E[0]||(E[0]=m=>b.value=m),init:f,disabled:i.disabled,"tag-name":"div","tinymce-script-src":"/tinymce/tinymce.min.js",licenseKey:"gpl","api-key":"no-api-key",id:i.id,inline:!1,"cloud-channel":"6","output-format":"html",style:ce({minHeight:typeof i.height=="number"?i.height+"px":String(i.height)})},null,8,["modelValue","disabled","id","style"]))}};function en({file:i,department_id:o,academic_year:l,semester:v,share_with:b}){const f=new FormData;return i&&f.append("file",i),o!=null&&o!==""&&f.append("department_id",o),l&&f.append("academic_year",l),v&&f.append("semester",v),Array.isArray(b)?b.forEach(_=>{_&&f.append("share_with[]",_)}):typeof b=="string"&&b.trim()&&f.append("share_with",b.trim()),f}const ke={async upload({file:i,department_id:o,academic_year:l,semester:v,share_with:b,onProgress:f}){const _=en({file:i,department_id:o,academic_year:l,semester:v,share_with:b}),{data:E}=await ye.post("/evidence/upload",_,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:m=>{try{if(!f)return;const p=m.total||i&&i.size||0,$=p?Math.round(m.loaded/p*100):Math.min(99,Math.round(m.loaded/1024));f($)}catch{}}});if(f)try{f(100)}catch{}return E},async getMeta(i){const{data:o}=await ye.get(`/evidence/${encodeURIComponent(i)}`);return o},async delete(i){const{data:o}=await ye.delete(`/evidence/${encodeURIComponent(i)}`);return o}},tn=kt("evidence",()=>{const i=w({}),o=w(!1),l=w(null),v=m=>{m?.id&&(i.value[m.id]={...i.value[m.id]||{},...m})};return{itemsById:i,isLoading:o,error:l,upload:async({file:m,department_id:p,academic_year:$,semester:G,share_with:x,onProgress:C}={})=>{l.value=null;try{o.value=!0;const D=await ke.upload({file:m,department_id:p,academic_year:$,semester:G,share_with:x,onProgress:C});return v(D),D}catch(D){throw l.value=D?.response?.data?.error||D?.message||"Failed to upload evidence",D}finally{o.value=!1}},getMeta:async m=>{l.value=null;try{o.value=!0;const p=await ke.getMeta(m);return v(p),p}catch(p){throw l.value=p?.response?.data?.error||p?.message||"Failed to fetch evidence metadata",p}finally{o.value=!1}},deleteById:async m=>{l.value=null;try{return o.value=!0,await ke.delete(m),delete i.value[m],!0}catch(p){throw l.value=p?.response?.data?.error||p?.message||"Failed to delete evidence",p}finally{o.value=!1}},reset:()=>{i.value={},o.value=!1,l.value=null}}}),nn={class:"flex items-center justify-between mb-3"},an={class:"text-lg font-semibold inline-flex items-center gap-2"},sn={class:"w-5 h-5 opacity-80",viewBox:"0 0 24 24"},ln=["d"],rn={key:0,class:T(["inline-flex items-center gap-1 px-2 py-[2px] rounded-full text-[11px] ring-1","bg-gray-50 text-gray-700 ring-gray-200"])},on={key:1,class:T(["inline-flex items-center gap-1 px-2 py-[2px] rounded-full text-[11px] ring-1","bg-indigo-50 text-indigo-700 ring-indigo-200"])},dn={key:0,class:"mb-3"},un={class:"flex items-center justify-between mb-2"},cn={class:"text-sm text-gray-700"},mn={class:"font-medium"},pn={class:"ml-2 text-gray-500"},vn={key:0},fn={key:3,class:"rounded-2xl border bg-white shadow-sm mb-4"},gn={class:"p-4"},yn={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3"},bn={class:"flex items-start justify-between gap-2"},xn={class:"min-w-0"},hn={class:"text-sm font-semibold text-gray-900"},_n={class:"mt-1 flex flex-wrap items-center gap-1"},kn={class:"inline-flex items-center rounded-full px-2 py-[2px] text-[11px] ring-1 ring-gray-200 bg-gray-50 text-gray-700"},Sn={key:0,class:"inline-flex items-center rounded-full px-2 py-[2px] text-[11px] ring-1 ring-gray-200 bg-gray-50 text-gray-700"},Cn={class:"mt-3 flex items-center justify-between"},wn={class:"w-full h-1.5 bg-gray-100 rounded"},Dn={class:"ml-2 text-[11px] text-gray-600"},An={class:"mt-3 text-right"},Ln={key:0,class:"col-span-full p-4 text-center text-gray-500"},En={key:4,class:"rounded-2xl border bg-white shadow-sm mb-4 p-4"},Mn={class:"grid grid-cols-1 md:grid-cols-4 gap-3"},Vn={class:"relative"},In={class:"relative"},Nn={class:"truncate"},Un={key:0},Bn={key:1},On={key:1},Pn={key:0,class:"absolute z-20 mt-1 w-full bg-white border rounded shadow-lg max-h-64 overflow-auto"},$n=["onClick"],Rn=["onClick"],Tn={class:"truncate mr-2"},Fn=["value"],jn=["disabled"],zn=["value"],Hn={key:2,class:"text-[11px] text-gray-500 mt-1"},Kn=["value"],Xn=["value"],Yn={key:5,class:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-4"},Wn={class:"rounded-2xl shadow-sm p-4 text-white bg-emerald-600"},qn={class:"mt-1 text-2xl font-semibold"},Gn={class:"rounded-2xl shadow-sm p-4 text-white bg-rose-600"},Jn={class:"mt-1 text-2xl font-semibold"},Qn={class:"rounded-2xl shadow-sm p-4 text-white bg-blue-600"},Zn={class:"mt-1 text-2xl font-semibold"},ea={key:6,class:"mb-2 flex flex-wrap items-center gap-3 text-[11px] text-gray-600"},ta={key:7,class:"rounded-2xl border bg-white shadow-sm overflow-x-auto max-h-[70vh] overflow-y-auto"},na={class:"w-full text-sm"},aa={class:"bg-gray-50 text-gray-700"},ia={class:"p-2 text-left align-top"},sa={class:"flex items-center gap-2"},la={class:"p-2 text-left align-top"},ra={class:"flex items-center gap-2"},oa={class:"p-1.5 align-top w-[150px]"},da={class:"text-gray-900 text-sm font-medium"},ua={class:"p-1.5 align-top min-w-[180px]"},ca=["innerHTML"],ma={class:"p-1.5 align-top w-[240px]"},pa={key:0,class:"space-y-1"},va=["href"],fa={key:1,class:"text-gray-500"},ga={key:1,class:"space-y-2"},ya=["onDragover","onDragleave","onDrop"],ba=["id","onChange"],xa={key:0,class:"ml-2 text-[12px] text-gray-600"},ha={key:1,class:"flex-1"},_a={class:"w-full h-2 bg-gray-200 rounded"},ka={class:"text-[11px] text-gray-500 mt-1"},Sa={key:0,class:"space-y-1"},Ca=["href"],wa={class:"p-1.5 align-top min-w-[180px]"},Da=["innerHTML"],Aa={class:"p-2 align-top min-w-[180px]"},La=["innerHTML"],Ea={class:"p-1.5 align-top w-[120px]"},Ma={key:0,class:"space-y-1"},Va=["onUpdate:modelValue"],Ia=["onUpdate:modelValue"],Na=["onUpdate:modelValue"],Ua={class:"mb-1"},Ba={class:"flex flex-wrap items-center gap-2"},Oa={key:0,class:"inline-flex items-center gap-1"},Pa=["title"],$a={class:"text-[11px] text-gray-600 capitalize"},Ra=["title"],Ta={key:2,class:"text-[11px] text-gray-500"},Fa={class:"mt-1 h-1 w-full bg-gray-100 rounded"},ja={class:"p-1.5 align-top text-right"},za={class:"mb-1 flex flex-wrap justify-end gap-1"},Ha={class:"flex flex-wrap justify-end gap-1 max-w-[120px] ml-auto"},Ka={key:0},Xa=25*1024*1024,Ya={__name:"CompliancePage",setup(i){const o=Ot(),l=Pt(),v=St(),b=tn(),f=Ct(),_=Dt(),E=S(()=>String(v.user?.role||"").toLowerCase()),m=S(()=>E.value==="admin"),p=S(()=>E.value==="user"),$=(()=>{const n=new Date().getFullYear();return Array.from({length:6},(t,e)=>`${n+e}-${n+e+1}`)})(),G=["1st Semester","2nd Semester","Summer"],x=w(""),C=w(""),D=w(""),I=w(""),O=w([]),X=w(!1),me=S(()=>{const n=Number(f.params?.departmentId||x.value);if(!n)return null;const t=o.departments?.data||[],e=j.value||[];return t.find(s=>Number(s.id)===n)||e.find(s=>Number(s.id)===n)||null}),k=w(""),V=n=>String(n?.membership?.role||n?.UserDepartment?.role||n?.user_department?.role||"").toLowerCase(),F=S(()=>{if(m.value)return(o.departments?.data||[]).slice();const t=(Array.isArray(j.value)?j.value:[]).map(s=>({id:s.id,name:s.name,_role:V(s)||"member"})),e=s=>s==="supervisor"?2:1;return t.sort((s,u)=>{const y=e(u._role)-e(s._role);return y!==0?y:String(s.name||"").localeCompare(String(u.name||""))})});S(()=>{if(m.value)return"";const n=Number(x.value||0);return(F.value||[]).find(e=>Number(e.id)===n)?._role||""}),q(x,async n=>{if(k.value="",!(!n||!v.user?.id))try{const t=await o.fetchMembers(Number(n),!0),e=(Array.isArray(t)?t:[]).find(u=>Number(u.id)===Number(v.user.id));let s=V(e);if(!s){const u=(j.value||[]).find(y=>Number(y.id)===Number(n));s=V(u)}k.value=s||""}catch{k.value=""}});const A=S(()=>{if(m.value)return"admin";const n=String(k.value||"").toLowerCase();return n==="supervisor"?"supervisor":n==="evaluator"?"evaluator":n==="manager"?"manager":"member"}),pe=S(()=>["member","supervisor","admin"].includes(A.value)),oe=S(()=>["supervisor","admin"].includes(A.value)),ve=S(()=>["supervisor","admin"].includes(A.value)),Se=S(()=>["supervisor","admin"].includes(A.value)),Ce=async()=>{if(O.value=[],!!x.value){X.value=!0;try{const n=await o.fetchMembers(Number(x.value),!0),t=Array.isArray(n)?n:[];O.value=t.filter(e=>String(e?.membership?.role||e?.UserDepartment?.role||e?.user_department?.role||"").toLowerCase()==="member")}catch{O.value=[]}finally{X.value=!1}}},Z=S(()=>(j.value||[]).some(t=>String(t?.membership?.role||t?.UserDepartment?.role||t?.user_department?.role||"").toLowerCase()==="supervisor"));q(()=>f.params.departmentId,async n=>{x.value=n?String(n):""});const He=w({page:1,limit:50}),we=async()=>{const n={page:1,limit:200};x.value&&(n.department_id=Number(x.value)),C.value&&(n.assigned_to_id=Number(C.value)),D.value&&(n.academic_year=D.value),I.value&&(n.semester=I.value),(A.value==="member"||A.value==="evaluator")&&v.user?.id&&(n.assigned_to_id=Number(v.user.id)),He.value=n,await l.fetchAll(n,!0)},j=w([]),P=S(()=>{const n=new Map,t=Array.isArray(l.list?.data)?l.list.data:[];(A.value==="member"?t.filter(u=>Number(u.assigned_to_id)===Number(v.user?.id)):C.value?t.filter(u=>Number(u.assigned_to_id)===Number(C.value)):t).forEach(u=>{const y=u.department_id,L=n.get(y)||{total:0,complied:0,latestAy:"",latestSem:"",latestCreatedAt:0};L.total+=1,u.status==="complied"&&(L.complied+=1);const de=u.created_at?new Date(u.created_at).getTime():0;de>=(L.latestCreatedAt||0)&&(L.latestCreatedAt=de,L.latestAy=u.academic_year||"",L.latestSem=u.semester||""),n.set(y,L)});const s={};for(const u of j.value){const y=n.get(u.id)||{total:0,complied:0,latestAy:"",latestSem:""},L=y.total?Math.round(y.complied/y.total*100):0;s[u.id]={...y,progress:L}}return s}),De=S(()=>{const n=ae.value;return n.length?{ay:n[0]?.academic_year||"",sem:n[0]?.semester||""}:{ay:"",sem:""}}),Ke=S(()=>D.value||De.value.ay||""),Ae=S(()=>I.value||De.value.sem||"");je(async()=>{if(await o.fetchAll({page:1,limit:200},!0),!m.value&&v.user?.id)try{if(j.value=await wt.getDepartments(v.user.id),p.value&&!Z.value&&(C.value=String(v.user.id),await l.fetchAll({page:1,limit:100,assigned_to_id:v.user.id},!0)),Z.value){if(!x.value){const n=(j.value||[])[0];n?.id&&(x.value=String(n.id))}!D.value&&Array.isArray($)&&$.length&&(D.value=$[0]),I.value||(I.value="1st Semester"),await Ce(),!C.value&&Array.isArray(O.value)&&O.value.length&&(C.value=String(O.value[0].id))}}catch{}f.params?.departmentId&&(x.value=String(f.params.departmentId)),await we()}),q([x,C,D,I],async()=>{await we()}),q(x,async()=>{C.value="",await Ce(),Z.value&&Array.isArray(O.value)&&O.value.length&&(C.value=String(O.value[0].id))});const ae=S(()=>Array.isArray(l.list?.data)?l.list.data:[]),fe=S(()=>{const n=ae.value.length,t=ae.value.filter(u=>u.status==="complied").length,e=ae.value.filter(u=>u.status==="in_progress").length,s=n?Math.round(t/n*100):0;return{total:n,complied:t,notcomplied:e,progress:s}}),Xe=n=>{const t=String(n||"").toLowerCase();return t==="governance"?"bg-indigo-50 text-indigo-700 ring-indigo-200":t==="records"?"bg-amber-50 text-amber-700 ring-amber-200":t==="processes"?"bg-sky-50 text-sky-700 ring-sky-200":t==="quality"?"bg-emerald-50 text-emerald-700 ring-emerald-200":t==="resources"?"bg-purple-50 text-purple-700 ring-purple-200":"bg-gray-50 text-gray-700 ring-gray-200"},Le=n=>{const t=String(n||"medium").toLowerCase();return t==="low"?"bg-emerald-500":t==="medium"?"bg-amber-500":t==="high"?"bg-orange-500":t==="urgent"?"bg-red-600":"bg-gray-400"},Ye=n=>Le(n),We=n=>{const t=String(n).toLowerCase();return t==="low"?"25%":t==="medium"?"50%":t==="high"?"75%":t==="urgent"?"100%":"50%"},qe=n=>{try{const t=new Date(n),e=new Date;return e.setHours(0,0,0,0),t<e?"bg-rose-50 text-rose-700 ring-rose-200":Math.ceil((t-e)/(1e3*60*60*24))<=3?"bg-amber-50 text-amber-700 ring-amber-200":"bg-gray-50 text-gray-700 ring-gray-200"}catch{return"bg-gray-50 text-gray-700 ring-gray-200"}},Ge=n=>{try{const t=new Date(n),e=new Date;return e.setHours(0,0,0,0),Math.ceil((t-e)/(1e3*60*60*24))}catch{return null}},Je=n=>{const t=Ge(n);return t==null?"Due date":t<0?"Overdue":t===0?"Due today":t===1?"Due in 1 day":`Due in ${t} days`},ee=w(""),ie=w("asc"),se=n=>{ee.value===n?ie.value=ie.value==="asc"?"desc":"asc":(ee.value=n,ie.value="asc")},le=n=>ee.value===n?ie.value==="asc"?"▲":"▼":"",Qe=n=>({low:1,medium:2,high:3,urgent:4})[String(n||"medium").toLowerCase()]||2,Ee=(n,t)=>t==="description"?String(n.standard?.description||""):t==="area"?String(n.standard?.area||""):t==="status"?String(n.status||""):t==="priority"?Qe(n.priority):t==="deadline"?n.deadline?new Date(n.deadline).getTime():Number.MAX_SAFE_INTEGER:"",Ze=S(()=>{const n=Array.isArray(l.list?.data)?[...l.list.data]:[];return ee.value?n.sort((t,e)=>{let s=Ee(t,ee.value),u=Ee(e,ee.value),y=0;return typeof s=="number"&&typeof u=="number"?y=s-u:y=String(s).localeCompare(String(u)),ie.value==="asc"?y:-y}):n});S(()=>A.value==="supervisor");const ge=S(()=>m.value||A.value==="supervisor"?!0:!!x.value),M=w({}),re=w({}),Me=w({}),te=w(!1),et=n=>t=>{t&&(Me.value[n]=t)},tt=n=>{try{const t=Me.value[n];t&&typeof t.click=="function"&&t.click()}catch{}};q(x,()=>{try{M.value={},re.value={}}catch{}});function nt(n){try{const t=String(n||"");let e=t.match(/\/file\/d\/([^/]+)/);return e&&e[1]||(e=t.match(/\/d\/([^/]+)/),e&&e[1])||(e=t.match(/[?&]id=([^&]+)/),e&&e[1])?e[1]:null}catch{return null}}function Ve(n){try{const e=JSON.parse(n);if(Array.isArray(e))return e.map(s=>String(s||"").trim()).filter(Boolean)}catch{}const t=String(n||"").trim();return t?t.split(/[\n,\s]+/).map(e=>e.trim()).filter(Boolean):[]}function at(n){const t=Array.isArray(n)?n.map(e=>String(e||"").trim()).filter(Boolean):[];return JSON.stringify(t)}const it=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],st=["image/"],lt=[".pdf",".doc",".docx",".xls",".xlsx"];async function Ie(n,t){if(!(it.includes(t.type)||st.some(y=>(t.type||"").startsWith(y))||lt.some(y=>(t.name||"").toLowerCase().endsWith(y))))return await H.fire("Unsupported file","Allowed: PDF, DOC/DOCX, XLS/XLSX, images.","warning"),!1;if(t.size>Xa)return await H.fire("File too large","Maximum size is 25 MB per file.","warning"),!1;const s=c(n);s.uploadingPct=1,s.isUploading=!0,s.uploadError=!1;const u=await b.upload({file:t,department_id:x.value||f.params.departmentId||"",academic_year:D.value||"",semester:I.value||"",onProgress:y=>{try{s.uploadingPct=Math.max(1,Math.min(100,y))}catch{}}});s.evidence_files.push({id:u.id,name:u.name,webViewLink:u.webViewLink}),s.uploadingPct=0,s.isUploading=!1;try{await H.fire("Uploaded","Evidence uploaded successfully.","success")}catch{}return!0}const rt=async(n,t)=>{try{const e=Array.from(t?.target?.files||[]);if(!e.length)return;for(const s of e)await Ie(n,s)}finally{try{t?.target&&(t.target.value="")}catch{}}},ot=(n,t)=>{try{const e=c(n);e.isDragging=!0}catch{}},dt=(n,t)=>{try{const e=c(n);e.isDragging=!1}catch{}},ut=async(n,t)=>{t.preventDefault();try{const e=c(n);e.isDragging=!1;const s=Array.from(t?.dataTransfer?.files||[]);if(!s.length)return;for(const u of s)await Ie(n,u)}catch{}},ct=async(n,t,e)=>{try{e?.id&&await b.deleteById(e.id)}catch{}try{c(n).evidence_files.splice(t,1)}catch{}},c=n=>{const t=re.value[n.id];if(t)return t;const e={self_assessment:n.self_assessment||"",evidence_url:n.evidence_url||"",evidence_links:Ve(n.evidence_url||""),evidence_files:Ve(n.evidence_url||"").map(s=>({id:nt(s),name:s,webViewLink:s})),findings:n.findings||"",recommendations:n.recommendations||"",status:n.status||"in_progress",priority:n.priority||"medium",deadline:n.deadline?new Date(n.deadline).toISOString().slice(0,10):"",uploadingPct:0,isDragging:!1,isUploading:!1,uploadError:!1};return re.value[n.id]=e,e},mt=n=>{n.isLocked||n.isCompleted||(M.value[n.id]=!0,c(n))},pt=async n=>{if(!(await H.fire({title:"Reset fields?",text:p.value?"This will clear self-evaluation and evidence only. You still need to save to persist.":"This will clear self-evaluation, evidence, findings, comments and set status to in_progress. You still need to save to persist.",icon:"warning",showCancelButton:!0,confirmButtonText:"Reset"})).isConfirmed)return;const e=c(n);pe.value&&(e.self_assessment="",e.evidence_url="",e.evidence_links=[],e.evidence_files=[]),oe.value&&(e.findings="",e.recommendations=""),ve.value&&(e.status="in_progress",e.priority="medium",e.deadline=""),M.value[n.id]=!0,await H.fire("Cleared","Row fields have been cleared. Click Save to persist.","success")},vt=async n=>{const t=re.value[n.id];if(!t||!(await H.fire({title:"Save changes?",text:"Persist the updated evaluation fields.",icon:"question",showCancelButton:!0,confirmButtonText:"Save"})).isConfirmed)return;const s={};if(pe.value){s.self_assessment=(t.self_assessment||"").trim()||null;const y=Array.isArray(t.evidence_files)?t.evidence_files.map(L=>String(L.webViewLink||"").trim()).filter(Boolean):[];s.evidence_url=y.length?at(y):null}oe.value&&(s.findings=(t.findings||"").trim()||null,s.recommendations=(t.recommendations||"").trim()||null),ve.value&&(s.status=t.status||"in_progress",s.priority=t.priority||"medium",s.deadline=t.deadline?new Date(t.deadline):null);const u=await l.updateById(n.id,s);try{const y=l.list?.data;if(Array.isArray(y)){const L=y.findIndex(de=>Number(de.id)===Number(n.id));L!==-1&&(y[L]={...y[L],...u})}}catch{}M.value[n.id]=!1,delete re.value[n.id],await H.fire("Saved","Evaluation updated successfully.","success")},ft=async n=>{if(!Se.value)return;const t=!n.isLocked;if(!(await H.fire({title:t?"Lock evaluation?":"Unlock evaluation?",icon:"question",showCancelButton:!0,confirmButtonText:t?"Lock":"Unlock"})).isConfirmed)return;const s=await l.updateById(n.id,{isLocked:t});try{const u=l.list?.data;if(Array.isArray(u)){const y=u.findIndex(L=>Number(L.id)===Number(n.id));y!==-1&&(u[y]={...u[y],...s})}}catch{}},Ne=n=>{const t=c(n),e=String(t?.self_assessment||"").trim(),s=Array.isArray(t?.evidence_files)?t.evidence_files.filter(u=>String(u.webViewLink||"").trim()):[];return!!(e&&s.length)},gt=async n=>{if(!["supervisor","admin"].includes(A.value))return;if(!Ne(n)){await H.fire("Incomplete","Please add self-evaluation and evidence before marking complete.","warning");return}if(!(await H.fire({title:"Mark as complete?",text:"This will set status to complied and lock editing.",icon:"question",showCancelButton:!0,confirmButtonText:"Complete"})).isConfirmed)return;const e=await l.updateById(n.id,{status:"complied",isCompleted:!0,completed_at:new Date});try{const s=l.list?.data;if(Array.isArray(s)){const u=s.findIndex(y=>Number(y.id)===Number(n.id));u!==-1&&(s[u]={...s[u],...e})}}catch{}};return(n,t)=>(r(),R(Lt,null,{default:ue(()=>[Y(Et,null,{default:ue(()=>[a("div",nn,[a("h1",an,[(r(),d("svg",sn,[a("path",{d:B(Mt)},null,8,ln)])),t[14]||(t[14]=N(" Compliance ",-1)),A.value==="member"?(r(),d("span",rn,[...t[12]||(t[12]=[a("span",{class:"inline-block h-2 w-2 rounded-full bg-gray-400"},null,-1),N(" member ",-1)])])):A.value==="supervisor"?(r(),d("span",on,[...t[13]||(t[13]=[a("span",{class:"inline-block h-2 w-2 rounded-full bg-indigo-500"},null,-1),N(" supervisor ",-1)])])):h("",!0)])]),A.value==="member"&&B(f).params.departmentId?(r(),d("div",dn,[a("div",un,[Y(W,{icon:B(Vt),color:"secondary",outline:"",small:"",label:"Back",onClick:t[0]||(t[0]=()=>B(_).push({name:"compliance"}))},null,8,["icon"]),a("div",cn,[a("span",mn,g(me.value?.name||"Department"),1),a("span",pn,[N(g(Ke.value||"-"),1),Ae.value?(r(),d("span",vn," • "+g(Ae.value),1)):h("",!0)])])])])):h("",!0),A.value==="member"?(r(),R(Pe,{key:1,color:"info",class:"mb-3"},{default:ue(()=>[...t[15]||(t[15]=[N(" You are viewing your assigned evaluations only. ",-1)])]),_:1})):h("",!0),A.value==="supervisor"?(r(),R(Pe,{key:2,color:"info",class:"mb-3"},{default:ue(()=>[...t[16]||(t[16]=[N(" You are viewing supervisor mode — department-wide evaluations. ",-1)])]),_:1})):h("",!0),p.value&&!Z.value&&!B(f).params.departmentId?(r(),d("div",fn,[t[17]||(t[17]=a("div",{class:"px-4 py-3 border-b flex items-center justify-between"},[a("h3",{class:"text-sm font-semibold text-gray-800"},"My Departments")],-1)),a("div",gn,[a("div",yn,[(r(!0),d(U,null,z(j.value,e=>(r(),d("div",{key:e.id,class:"rounded-xl border p-4 hover:shadow-sm transition"},[a("div",bn,[a("div",xn,[a("div",hn,g(e.name),1),a("div",_n,[a("span",kn," AY: "+g(P.value[e.id]?.latestAy||"-"),1),P.value[e.id]?.latestSem?(r(),d("span",Sn,g(P.value[e.id]?.latestSem),1)):h("",!0)])]),a("div",null,[P.value[e.id]?(r(),d("span",{key:0,class:T(["inline-flex items-center rounded-full px-2 py-[2px] text-[11px] ring-1",P.value[e.id].progress>=80?"bg-emerald-50 text-emerald-700 ring-emerald-200":P.value[e.id].progress>0?"bg-amber-50 text-amber-700 ring-amber-200":"bg-gray-50 text-gray-700 ring-gray-200"])},g(P.value[e.id].complied)+"/"+g(P.value[e.id].total),3)):h("",!0)])]),a("div",Cn,[a("div",wn,[a("div",{class:T(["h-1.5 rounded",P.value[e.id]?.progress>=80?"bg-emerald-500":P.value[e.id]?.progress>0?"bg-amber-500":"bg-gray-300"]),style:ce({width:(P.value[e.id]?.progress||0)+"%"})},null,6)]),a("div",Dn,g(P.value[e.id]?.progress||0)+"%",1)]),a("div",An,[Y(W,{small:"",color:"primary",label:"View",onClick:()=>B(_).push({name:"compliance",params:{departmentId:e.id}})},null,8,["onClick"])])]))),128)),j.value.length?h("",!0):(r(),d("div",Ln,"No department assignments."))])])])):h("",!0),m.value||Z.value?(r(),d("div",En,[a("div",Mn,[a("div",Vn,[t[19]||(t[19]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Department",-1)),a("div",In,[a("button",{type:"button",onClick:t[1]||(t[1]=e=>te.value=!te.value),class:"w-full border rounded px-3 py-2 text-left flex items-center justify-between"},[a("span",Nn,[m.value?(r(),d(U,{key:0},[x.value?(r(),d("span",Bn,g((B(o).departments?.data||[]).find(e=>Number(e.id)===Number(x.value))?.name||"Department"),1)):(r(),d("span",Un,"All"))],64)):(r(),d("span",On,g((F.value||[]).find(e=>Number(e.id)===Number(x.value))?.name||"Select department"),1))]),t[18]||(t[18]=a("span",{class:"ml-2 text-gray-400"},"▾",-1))]),te.value?(r(),d("div",Pn,[m.value?(r(),d(U,{key:0},[a("div",{onClick:t[2]||(t[2]=e=>{x.value="",te.value=!1}),class:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer"},"All"),(r(!0),d(U,null,z(B(o).departments?.data||[],e=>(r(),d("div",{key:"ad-"+e.id,onClick:s=>{x.value=e.id,te.value=!1},class:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer"},g(e.name),9,$n))),128))],64)):(r(!0),d(U,{key:1},z(F.value,e=>(r(),d("div",{key:"md-"+e.id,onClick:s=>{x.value=e.id,te.value=!1},class:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer flex items-center justify-between"},[a("span",Tn,g(e.name),1),a("span",{class:T(["inline-flex items-center gap-1 px-2 py-[2px] rounded-full text-[11px] ring-1",e._role==="supervisor"?"bg-indigo-50 text-indigo-700 ring-indigo-200":"bg-gray-50 text-gray-700 ring-gray-200"])},[a("span",{class:T(["inline-block h-2 w-2 rounded-full",e._role==="supervisor"?"bg-indigo-500":"bg-gray-400"])},null,2),N(" "+g(e._role),1)],2)],8,Rn))),128))])):h("",!0)])]),a("div",null,[t[21]||(t[21]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Name of Faculty (Assignee)",-1)),Z.value&&!m.value?J((r(),d("select",{key:0,"onUpdate:modelValue":t[3]||(t[3]=e=>C.value=e),class:"w-full border p-2 rounded"},[(r(!0),d(U,null,z(O.value,e=>(r(),d("option",{key:e.id,value:e.id},"@"+g(e.username)+" — "+g(e.first_name||"")+" "+g(e.last_name||""),9,Fn))),128))],512)),[[ne,C.value]]):h("",!0),m.value?J((r(),d("select",{key:1,"onUpdate:modelValue":t[4]||(t[4]=e=>C.value=e),class:"w-full border p-2 rounded",disabled:!x.value},[t[20]||(t[20]=a("option",{value:""},"All",-1)),(r(!0),d(U,null,z(O.value,e=>(r(),d("option",{key:e.id,value:e.id},"@"+g(e.username)+" — "+g(e.first_name||"")+" "+g(e.last_name||""),9,zn))),128))],8,jn)),[[ne,C.value]]):h("",!0),X.value?(r(),d("div",Hn,"Loading members…")):h("",!0)]),a("div",null,[t[23]||(t[23]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"School Year",-1)),J(a("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>D.value=e),class:"w-full border p-2 rounded"},[t[22]||(t[22]=a("option",{value:""},"All",-1)),(r(!0),d(U,null,z(B($),e=>(r(),d("option",{key:e,value:e},g(e),9,Kn))),128))],512),[[ne,D.value]])]),a("div",null,[t[25]||(t[25]=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Semester",-1)),J(a("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>I.value=e),class:"w-full border p-2 rounded"},[t[24]||(t[24]=a("option",{value:""},"All",-1)),(r(),d(U,null,z(G,e=>a("option",{key:e,value:e},g(e),9,Xn)),64))],512),[[ne,I.value]])])])])):h("",!0),ge.value?(r(),d("div",Yn,[a("div",Wn,[t[26]||(t[26]=a("div",{class:"text-sm opacity-90"},"Complied",-1)),a("div",qn,g(fe.value.complied),1)]),a("div",Gn,[t[27]||(t[27]=a("div",{class:"text-sm opacity-90"},"Not Complied",-1)),a("div",Jn,g(fe.value.notcomplied),1)]),a("div",Qn,[t[28]||(t[28]=a("div",{class:"text-sm opacity-90"},"Progress (%)",-1)),a("div",Zn,g(fe.value.progress)+"%",1)])])):h("",!0),ge.value?(r(),d("div",ea,[...t[29]||(t[29]=[a("div",{class:"flex items-center gap-1"},[a("span",{class:"inline-block h-2.5 w-2.5 rounded-full bg-emerald-500"}),N(" Low")],-1),a("div",{class:"flex items-center gap-1"},[a("span",{class:"inline-block h-2.5 w-2.5 rounded-full bg-amber-500"}),N(" Medium")],-1),a("div",{class:"flex items-center gap-1"},[a("span",{class:"inline-block h-2.5 w-2.5 rounded-full bg-orange-500"}),N(" High")],-1),a("div",{class:"flex items-center gap-1"},[a("span",{class:"inline-block h-2.5 w-2.5 rounded-full bg-red-600"}),N(" Urgent")],-1),a("div",{class:"flex items-center gap-1 ml-3"},[a("span",{class:"px-1.5 py-0.5 rounded ring-1 bg-rose-50 text-rose-700 ring-rose-200"},"Due"),N(" Overdue")],-1),a("div",{class:"flex items-center gap-1"},[a("span",{class:"px-1.5 py-0.5 rounded ring-1 bg-amber-50 text-amber-700 ring-amber-200"},"Due"),N(" Soon")],-1),a("div",{class:"flex items-center gap-1"},[a("span",{class:"px-1.5 py-0.5 rounded ring-1 bg-gray-50 text-gray-700 ring-gray-200"},"Due"),N(" Scheduled")],-1),a("div",{class:"flex items-center gap-1 ml-3 text-gray-500"},"Completed shows completion date",-1)])])):h("",!0),ge.value?(r(),d("div",ta,[a("table",na,[a("thead",null,[a("tr",aa,[a("th",ia,[a("div",sa,[a("button",{class:"text-sm font-medium hover:underline",onClick:t[7]||(t[7]=e=>se("description"))}," Standards "+g(le("description")),1),a("button",{class:"text-[11px] text-gray-600 hover:underline",onClick:t[8]||(t[8]=e=>se("area"))}," Area "+g(le("area")),1)])]),t[30]||(t[30]=a("th",{class:"p-2 text-left align-top"},"Self-Evaluation",-1)),t[31]||(t[31]=a("th",{class:"p-2 text-left align-top"},"Evidence",-1)),t[32]||(t[32]=a("th",{class:"p-2 text-left align-top"},"Findings",-1)),t[33]||(t[33]=a("th",{class:"p-2 text-left align-top"},"Comments / Recommendations",-1)),a("th",la,[a("div",ra,[a("button",{class:"text-sm font-medium hover:underline",onClick:t[9]||(t[9]=e=>se("status"))},"Status "+g(le("status")),1),a("button",{class:"text-[11px] text-gray-600 hover:underline",onClick:t[10]||(t[10]=e=>se("priority"))},"Priority "+g(le("priority")),1),a("button",{class:"text-[11px] text-gray-600 hover:underline",onClick:t[11]||(t[11]=e=>se("deadline"))},"Due "+g(le("deadline")),1)])]),t[34]||(t[34]=a("th",{class:"p-2 text-right align-top"},"Actions",-1))])]),a("tbody",null,[(r(!0),d(U,null,z(Ze.value,e=>(r(),d("tr",{key:`${e.id}-${M.value[e.id]?"edit":"view"}`,class:"border-t"},[a("td",oa,[a("div",{class:T(["inline-flex items-center rounded-full px-2 py-[2px] text-[11px] ring-1 mb-1",Xe(e.standard?.area)])},g(e.standard?.area||"Area"),3),a("div",da,g(e.standard?.description||"(no description)"),1)]),a("td",ua,[M.value[e.id]?(r(),R(_e,{key:`sa-${e.id}-${M.value[e.id]}`,id:`sa-${e.id}`,modelValue:c(e).self_assessment,"onUpdate:modelValue":s=>c(e).self_assessment=s,height:180,placeholder:"Self-evaluation / actual situation"},null,8,["id","modelValue","onUpdate:modelValue"])):(r(),d("div",{key:0,class:"prose prose-sm max-w-none",innerHTML:c(e).self_assessment||"-"},null,8,ca))]),a("td",ma,[!M.value[e.id]||!pe.value?(r(),d(U,{key:0},[c(e).evidence_files?.length?(r(),d("div",pa,[(r(!0),d(U,null,z(c(e).evidence_files,(s,u)=>(r(),d("div",{key:s.id||s.webViewLink||u,class:"flex items-start gap-2"},[a("a",{href:s.webViewLink||s.link||"#",target:"_blank",class:"text-blue-600 hover:underline break-words break-all whitespace-normal text-xs max-w-full"},g(s.name||s.webViewLink),9,va)]))),128))])):(r(),d("span",fa,"-"))],64)):(r(),d("div",ga,[a("div",{class:T(["flex items-center gap-2 rounded-lg border-2 border-dashed p-3",c(e).isDragging?"border-primary bg-primary/5":"border-gray-200"]),onDragover:Oe(s=>ot(e,s),["prevent"]),onDragleave:s=>dt(e,s),onDrop:Oe(s=>ut(e,s),["prevent"])},[a("input",{id:`evu-${e.id}`,type:"file",class:"hidden",ref_for:!0,ref:et(e.id),accept:"application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,image/*,.pdf,.doc,.docx,.xls,.xlsx",onChange:s=>rt(e,s)},null,40,ba),Y(W,{icon:B(It),color:"primary",disabled:c(e).uploadingPct>0,label:"Upload evidence",onClick:()=>tt(e.id)},null,8,["icon","disabled","onClick"]),c(e).uploadingPct?h("",!0):(r(),d("div",xa,"or drag & drop files here")),c(e).uploadingPct>0?(r(),d("div",ha,[a("div",_a,[a("div",{class:"h-2 rounded bg-primary transition-all",style:ce({width:(c(e).uploadingPct||0)+"%"})},null,4)]),a("div",ka,"Uploading... "+g(c(e).uploadingPct||0)+"% ",1)])):h("",!0)],42,ya),c(e).evidence_files?.length?(r(),d("div",Sa,[(r(!0),d(U,null,z(c(e).evidence_files,(s,u)=>(r(),d("div",{key:s.id||s.webViewLink||u,class:"flex items-start gap-2"},[a("a",{href:s.webViewLink,target:"_blank",class:"flex-1 text-blue-600 hover:underline break-words break-all whitespace-normal text-xs max-w-full"},g(s.name||s.webViewLink),9,Ca),Y(W,{small:"",color:"danger",outline:"",label:"Remove",onClick:()=>ct(e,u,s)},null,8,["onClick"])]))),128))])):h("",!0),t[35]||(t[35]=a("div",{class:"text-[11px] text-gray-500"},"Allowed: PDF, DOC/DOCX, XLS/XLSX, images. Max 25 MB.",-1))]))]),a("td",wa,[!M.value[e.id]||!oe.value?(r(),d("div",{key:0,class:"prose prose-sm max-w-none",innerHTML:c(e).findings||"-"},null,8,Da)):(r(),R(_e,{key:`fd-${e.id}-${M.value[e.id]}`,id:`fd-${e.id}`,modelValue:c(e).findings,"onUpdate:modelValue":s=>c(e).findings=s,height:160,placeholder:"Findings"},null,8,["id","modelValue","onUpdate:modelValue"]))]),a("td",Aa,[!M.value[e.id]||!oe.value?(r(),d("div",{key:0,class:"prose prose-sm max-w-none",innerHTML:c(e).recommendations||"-"},null,8,La)):(r(),R(_e,{key:`rc-${e.id}-${M.value[e.id]}`,id:`rc-${e.id}`,modelValue:c(e).recommendations,"onUpdate:modelValue":s=>c(e).recommendations=s,height:160,placeholder:"Comments / recommendations"},null,8,["id","modelValue","onUpdate:modelValue"]))]),a("td",Ea,[M.value[e.id]&&ve.value?(r(),d("div",Ma,[J(a("select",{"onUpdate:modelValue":s=>c(e).status=s,class:"w-full border rounded p-1 text-xs"},[...t[36]||(t[36]=[a("option",{value:"in_progress"},"in_progress",-1),a("option",{value:"complied"},"complied",-1),a("option",{value:"not_complied"},"not_complied",-1)])],8,Va),[[ne,c(e).status]]),J(a("select",{"onUpdate:modelValue":s=>c(e).priority=s,class:"w-full border rounded p-1 text-xs"},[...t[37]||(t[37]=[a("option",{value:"low"},"low",-1),a("option",{value:"medium"},"medium",-1),a("option",{value:"high"},"high",-1),a("option",{value:"urgent"},"urgent",-1)])],8,Ia),[[ne,c(e).priority]]),J(a("input",{type:"date","onUpdate:modelValue":s=>c(e).deadline=s,class:"w-full border rounded p-1 text-xs"},null,8,Na),[[At,c(e).deadline]])])):(r(),d(U,{key:1},[a("div",Ua,[Y(be,{text:c(e).status,tone:c(e).status==="complied"?"emerald":c(e).status==="in_progress"?"indigo":"gray"},null,8,["text","tone"])]),a("div",Ba,[(c(e).priority||"medium")!=="medium"?(r(),d("div",Oa,[a("span",{title:`Priority: ${c(e).priority}`,class:T(["inline-block h-2.5 w-2.5 rounded-full",Le(c(e).priority||"medium")])},null,10,Pa),a("span",$a,g(c(e).priority),1)])):h("",!0),c(e).status==="in_progress"&&c(e).deadline?(r(),d("div",{key:1,title:Je(c(e).deadline),class:T(["px-1.5 py-0.5 rounded text-[10px] ring-1",qe(c(e).deadline)])},"Due: "+g(new Date(c(e).deadline).toLocaleDateString()),11,Ra)):h("",!0),c(e).status==="complied"&&e.completed_at?(r(),d("div",Ta,"Completed: "+g(new Date(e.completed_at).toLocaleDateString()),1)):h("",!0)]),a("div",Fa,[a("div",{class:T(["h-1 rounded",Ye(c(e).priority||"medium")]),style:ce({width:We(c(e).priority||"medium")})},null,6)])],64))]),a("td",ja,[a("div",za,[e.isCompleted?(r(),R(be,{key:0,text:"Completed",tone:"emerald"})):h("",!0),e.isLocked?(r(),R(be,{key:1,text:"Locked",tone:"amber"})):h("",!0)]),a("div",Ha,[Y(W,{icon:B(Nt),small:"",color:"secondary",outline:"",disabled:M.value[e.id]||e.isLocked||e.isCompleted,label:"Edit",onClick:s=>mt(e)},null,8,["icon","disabled","onClick"]),Y(W,{icon:B(Ut),small:"",color:"info",outline:"",disabled:!M.value[e.id],label:"Reset",onClick:s=>pt(e)},null,8,["icon","disabled","onClick"]),Y(W,{icon:B(Bt),small:"",color:"primary",disabled:!M.value[e.id]||c(e).isUploading,label:"Save",onClick:s=>vt(e)},null,8,["icon","disabled","onClick"]),Se.value?(r(),R(W,{key:0,small:"",color:e.isLocked?"secondary":"warning",label:e.isLocked?"Unlock":"Lock",onClick:s=>ft(e)},null,8,["color","label","onClick"])):h("",!0),["supervisor","admin"].includes(A.value)&&!e.isCompleted?(r(),R(W,{key:1,small:"",color:"emerald",disabled:!Ne(e),outline:"",label:"Mark Complete",onClick:s=>gt(e)},null,8,["disabled","onClick"])):h("",!0)])])]))),128)),ae.value.length?h("",!0):(r(),d("tr",Ka,[...t[38]||(t[38]=[a("td",{colspan:"9",class:"p-4 text-center text-gray-500"},"No evaluations found for the selected filters.",-1)])]))])])])):h("",!0)]),_:1})]),_:1}))}},ii=$t(Ya,[["__scopeId","data-v-f0ae8271"]]);export{ii as default};
